# THz 时域光谱分析系统使用说明

## 项目结构

```
GUI-Optical-parameter-extraction/
├── main.py                 # 程序主入口
├── setup.py               # 安装配置文件
├── requirements.txt       # 依赖包列表
├── thz_config.json       # 配置文件
├── README.md             # 说明文档
├── core/                 # 核心计算模块
│   ├── __init__.py
│   ├── calculator.py     # 光学参数计算
│   └── data_io.py       # 数据输入输出
├── gui/                  # 用户界面模块
│   ├── __init__.py
│   ├── main_window.py   # 主窗口
│   └── canvas.py        # 图表画布
├── config/              # 配置管理模块
│   ├── __init__.py
│   └── config_manager.py # 配置文件管理
└── utils/               # 工具函数模块
    ├── __init__.py
    └── matplotlib_setup.py # matplotlib配置
```

## 安装要求

### 依赖项
- Python 3.7+
- PyQt5
- numpy
- matplotlib
- pandas
- openpyxl

### 安装依赖
```bash
pip install -r requirements.txt
```

## 运行程序

### 直接运行主程序
```bash
python main.py
```

## 使用方法

### 数据格式要求
- 输入文件支持Excel格式（.xlsx或.xls）和文本格式（.txt）
- 每个文件应包含两列数据：第一列为时间，第二列为信号振幅
- 可设置数据起始行（跳过表头行）
- 对于txt文件，支持自动检测分隔符（空格、制表符、逗号等）

### 基本操作流程

1. **选择参考文件**
   - 点击"添加文件"按钮选择参考文件
   - 参考文件是无样品的基准测量结果
   - 支持拖放文件到参考文件输入框

2. **添加样品文件**
   - 点击"添加文件"按钮选择一个或多个样品文件
   - 每个文件名将自动作为样品名称显示在列表中
   - 可以通过"删除选中"或"清空列表"按钮管理样品列表
   - 支持拖放文件到样品列表

3. **设置参数**
   - 样品厚度(mm)：输入样品的实际厚度，单位为毫米（支持历史记录）
   - 数据起始行：设置数据内容的起始行数，用于跳过表头

4. **运行分析**
   - 点击"运行分析"按钮开始计算
   - 系统将自动计算光学参数并显示图表

5. **查看结果**
   - "时域和频域信号"标签页显示时域波形和频域谱图
   - "光学参数"标签页显示折射率、消光系数和吸收系数
   - "介电特性"标签页显示介电常数实部、虚部和介电损耗

6. **保存结果**
   - 分析完成后，点击"保存结果"按钮
   - 选择保存位置和文件名
   - 结果将以Excel格式保存，包含所有计算的光学参数

### 拖放功能

支持文件拖放操作：
- 将参考文件拖放到"参考文件"区域
- 将样品文件拖放到样品列表区域
- 自动识别文件类型并添加到相应位置

### 结果说明

分析结果包含以下几部分：
1. **时域信号**：显示参考信号和样品信号的时域波形
2. **频域信号**：显示参考信号和样品信号的频域谱图
3. **折射率**：反映样品对太赫兹波的折射能力
4. **消光系数**：反映样品对太赫兹波的吸收能力
5. **吸收系数**：以cm⁻¹为单位的吸收系数
6. **介电常数实部**：材料的介电响应实部
7. **介电常数虚部**：材料的介电响应虚部  
8. **介电损耗**：材料的介电损耗因子
5. **吸收系数**：以cm^-1为单位的吸收强度

所有图表可以通过内置工具栏进行缩放、平移和保存。

## 注意事项

1. 参考文件和样品文件的数据点数必须相同，否则系统会自动截断到最短长度并显示警告
2. 样品厚度必须为正数
3. 频率显示范围默认限制在0-5 THz，这是太赫兹时域光谱的常用范围
4. 确保Excel文件第一列为时间，第二列为信号振幅
5. 运行后会自动保存配置到thz_config.json文件中

 